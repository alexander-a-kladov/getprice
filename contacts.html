<p><a href=https://topdeck.ru/forums/topic/169221-%D0%BF%D1%80%D0%BE%D0%B4%D0%B0%D0%BC-%D0%BA%D0%B0%D1%80%D1%82%D1%8B-%D0%B2-%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82-%D0%B8-%D0%B2%D0%B5%D1%87%D0%BD%D1%8B%D0%B5-%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D1%8B target="_blank">Торговая Тема</a>
<a style="margin-left: 20px" href=https://topdeck.ru/messenger/compose/?to=10345 target="_blank">Сообщение</a>
<a style="margin-left: 40px" href=https://t.me/xanderkladov target="_blank">Телеграмм</a></p>
<p><details>
<summary><b>Инструкция</b></summary>
<p><b>"Торговая тема"</b> - переход в торговую тему topdeck.ru </p>
<p><b>"Сообщение"</b> - переход на форму сообщения для покупки topdeck.ru </p>
<p><b>"Вконтакте"</b> - переход на страницу Вконтакте </p>
<p><b>Клик на изображение карты</b> - переход на поиск карт с названием карты topdeck.ru </p>
<p><b>Ctrl (удерживание после клика) + Клик на изображение карты</b> - переход на поиск карты c названием карты mtggoldfish.com </p>
</details></p>
<script type="text/javascript">
var lastResFind=""; // последний удачный результат
var copy_page=""; // копия страницы в исходном виде
var input;

function TrimStr(s) {
     s = s.replace( /^\s+/g, '');
  return s.replace( /\s+$/g, '');
}

function toggleSpoilers() {
  var spoilers = [].slice.call(document.querySelectorAll('summary'));
  delete spoilers[0];
  spoilers.forEach(function(node) {
  node.click();
  });
}

function AddToBasket() {
  let inputs = window.document.getElementsByTagName("input");
  let summ = 0;
  let number = 0;
  let result_str = "Здравствуйте. Хочу купить у вас следующие карты:\n"; 
  for (let i = 1; i < inputs.length; i++) {
  	if (Number(inputs[i].value)>0) {
  	let price = inputs[i].nextElementSibling.nextElementSibling.innerHTML.split('<span>').join('').split(' ');
  	price = Number(price[price.length-2]);
  	let name = inputs[i].parentElement.lastElementChild.innerHTML.split('<wbr>').join(' ');
  	let quantity = 1;
  	let value = Number(inputs[i].value);
  	if (~name.indexOf('x ')) {
  	if (name.split('x ')[0].match(/(-?\d+(\.\d+)?)/g)) {
  		quantity = Number(name.split('x ')[0]);
  		name = name.split(quantity+'x ')[1];
  	}
  	}
  	
  	if (value>quantity) {
  		value = quantity;
  	}
  	number += value;
  	summ += value * price;
  	result_str += value + " "+ name +" "+ price+" р \n";
  	}
  }
  result_str+="\nСумма "+summ+" р\nКоличество карт "+number;
  navigator.clipboard.writeText(result_str)
                .then(() => {
                console.log('Copy to clipboard='+url);
                    })
                .catch(err => {
                console.log('Something went wrong', err);
                });
  alert(result_str+"\n\n Скопировано в буфер обмена");
 }

</script>

<input type="button" id="find-button" onclick="javascript: AddToBasket(); return false;" value="Добавить в корзину"/>
<br/>
<hr/>


